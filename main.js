!function(e){function t(s){if(r[s])return r[s].exports;var a=r[s]={exports:{},id:s,loaded:!1};return e[s].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";var s=r(4),a=r(6),n=r(1),i=(new s.Title,new a.Search),o=new n.Carousel;i.searchStr.observerAdd(o.carouselDataModel)},function(e,t,r){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Carousel=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),n=r(3),i=r(2),o=function(){function e(){s(this,e),this.carouselTemplate=new n.CarouselView,this.carouselDataModel=new i.CarouselDataModel,this.update=this.updateCarouselView,this.carouselDataModel.addObserver(this),this.carouselTemplate.addObserver(this),this.isSliderExist=!1}return a(e,[{key:"updateCarouselView",value:function(e,t){console.log("call view methods to update carousel"),console.dir(e),this.isSliderExist||(this.carouselTemplate.showCarousel(),this.isSliderExist=!0,this.addEvents()),"delete"===t&&this.carouselTemplate.cleanCarousel(),e.items.length&&(console.log("update add cards run"),this.carouselTemplate.addCards(e)),this.carouselTemplate.updateIndicators()}},{key:"addEvents",value:function(){var e=this;this.next=document.getElementById("nextButton"),this.prev=document.getElementById("prevButton"),this.next.addEventListener("click",function(){e.carouselTemplate.showNextBlock()}),this.prev.addEventListener("click",function(){e.carouselTemplate.showPrevBlock()}),window.addEventListener("resize",function(){e.carouselTemplate.fixView()}),this.carousel=document.getElementById("carousel__cards"),this.carousel.addEventListener("mousedown",function(t){e.carouselTemplate.swipeStart(t)}),this.carousel.addEventListener("mousemove",function(t){e.carouselTemplate.swipeMove(t)}),document.addEventListener("mouseup",function(t){e.carouselTemplate.swipeEnd(t)}),this.carousel.addEventListener("touchstart",function(t){e.carouselTemplate.swipeStart(t)}),this.carousel.addEventListener("touchmove",function(t){e.carouselTemplate.swipeMove(t)}),this.carousel.addEventListener("touchend",function(t){e.carouselTemplate.swipeEnd(t)}),this.wrapperPoints=document.getElementById("wrapper_points"),this.wrapperPoints.addEventListener("click",function(t){"SPAN"===t.target.tagName&&e.carouselTemplate.showIndexBlock(t)})}},{key:"loadNextPart",value:function(){console.log("load next data from controller"),this.carouselDataModel.getDataRequest("nextPage")}}]),e}();t.Carousel=o},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),a=function(){function e(){r(this,e),this.url="",this.queryObj={queryText:"",APIKey:"AIzaSyC9Z_Pl3wEWvCoTdcCMAx5mCvjf4PxJiVk",part:"snippet",type:"video",maxResults:15,basePart:"https://www.googleapis.com/youtube/v3/",nextPageToken:""},this.observList=[],this.deleteCards="save"}return s(e,[{key:"getDataRequest",value:function(e){var t=this;"nextPage"!==e&&e!==this.queryObj.queryText&&(this.queryObj.nextPageToken="",this.queryObj.queryText=e,this.deleteCards="delete"),"noPages"!==this.queryObj.nextPageToken&&(console.log("carousel model data"),console.log(this.queryObj.queryText),this.makeUrl(),this.getData(this.url).then(function(e){var r=JSON.parse(e);console.log(r),t.queryObj.nextPageToken=r.nextPageToken||"noPages",console.log(t.queryObj.nextPageToken);var s=r.items.reduce(function(e,t){return e+","+t.id.videoId},"");return s=s.slice(1)},function(e){return console.log("Rejected: "+e)}).then(function(e){return console.log("str from then "+e),t.getData(t.queryObj.basePart+"videos?key="+t.queryObj.APIKey+"&id="+e+"&part="+t.queryObj.part+",statistics")}).then(function(e){var r=JSON.parse(e);t.notifyOnUpdate(r,t.deleteCards),t.deleteCards="save"}))}},{key:"makeUrl",value:function(){this.url=this.queryObj.basePart+"search?key="+this.queryObj.APIKey+"&type="+this.queryObj.type+"&part="+this.queryObj.part+"&maxResults="+this.queryObj.maxResults+"&q="+this.queryObj.queryText+"&pageToken="+this.queryObj.nextPageToken,console.log(this.url)}},{key:"getData",value:function(e){return new Promise(function(t,r){var s=new XMLHttpRequest;s.open("GET",e,!0),s.onload=function(){if(200===this.status)t(this.response);else{var e=new Error(this.statusText);e.code=this.status,r(e)}},s.onerror=function(){r(new Error("Network Error"))},s.send()})}},{key:"addObserver",value:function(e){this.observList.push(e)}},{key:"notifyOnUpdate",value:function(e,t){this.observList.forEach(function(r){r.update(e,t)})}}]),e}();t.CarouselDataModel=a},function(e,t,r){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}();r(9);var n=function(){function e(){s(this,e),this.step=0,this.carouselCardsLeft=0,this.leftCardNumber=1,this.cardsVeiwCount=0,this.currentPage=1,this.pagesNumber=0,this.carouselMask=null,this.carouselCards=null,this.firstCardElement=null,this.cardsCount=0,this.touchStartX=0,this.touchEndX=0,this.diffStartEndX=0,this.init=!1,this.maxIndicatorsNumber=7,this.observer=[]}return a(e,[{key:"showCarousel",value:function(e){var t=e||document.body,r='\n           <div class="wrapper_carousel">\n              <div class="carousel">\n                    <div id="carousel__mask" class="carousel__mask">\n                        <div id="carousel__cards"></div>\n                    </div>\n                    <div id="carousel__controls">\n                        <div class="wrapper_buttons"><span id="prevButton" class="carousel__button">prev</span><span id="nextButton" class="carousel__button">next</span></div>\n                    </div>\n                    <div id="carousel__indicators">\n                        <div id="wrapper_points" class="wrapper_points"></div>\n                    </div>\n              </div>\n           </div>\n           ';t.insertAdjacentHTML("beforeEnd",r),this.carouselMask=document.getElementById("carousel__mask"),this.carouselCards=document.getElementById("carousel__cards")}},{key:"addCards",value:function(e){console.log("add new cards");for(var t=document.createDocumentFragment(),r=0,s=e.items.length;r<s;r++){var a=document.createElement("div");a.classList.add("card"),a.innerHTML=this.cardTemplate(e.items[r]),t.appendChild(a)}this.carouselCards.appendChild(t),this.init||this.initCarousel()}},{key:"cardTemplate",value:function(e){var t={link:"https://www.youtube.com/watch?v="+e.id||"#",src:e.snippet.thumbnails.medium.url||"",title:e.snippet.localized.title||"title",author:e.snippet.channelTitle||"author",views:e.statistics.viewCount||"views",date:e.snippet.publishedAt.substring(0,10)||"date",description:e.snippet.localized.description||"description"};return'<a href="'+t.link+'" class="card__link"><img src="'+t.src+'" alt="" class="card__image"></a>\n                <div class="card__content">\n                    <a href="'+t.link+'" class="card__link"><h3 class="card__title" title="'+t.title+'">'+t.title+'</h3></a>\n                    <div class="card__rate clrfix">\n                        <div class="card__author">'+t.author+'</div>\n                        <div class="card__date">'+t.date+'</div>\n                        <div class="card__views">'+t.views+' views</div>\n                        <div class="card__description">'+t.description+"</div>\n                    </div>\n                </div>"}},{key:"initCarousel",value:function(){this.firstCardElement=this.carouselCards.children[0],this.calcStep(),this.cardsCount=this.carouselCards.children.length,this.countCardsView(),this.countPagesNumber()}},{key:"cleanCarousel",value:function(){this.carouselCards.innerHTML="",this.carouselCardsLeft=0,this.carouselCards.style.left=this.carouselCardsLeft+"px",this.currentPage=1}},{key:"updateIndicators",value:function(){for(var e=this.currentPage-Math.floor(this.maxIndicatorsNumber/2),t=this.currentPage+Math.floor(this.maxIndicatorsNumber/2),r="",s=e;s<=t;s++)if(s<=0)t++;else{if(s>this.pagesNumber)break;r+='<span class="carousel__point '+(this.currentPage===s?"carousel__point_active":"")+'">'+s+"</span>"}var a=document.getElementById("wrapper_points");a.innerHTML=r}},{key:"calcStep",value:function(){var e=this.firstCardElement.currentStyle||window.getComputedStyle(this.firstCardElement),t=parseFloat(e.marginRight),r=parseFloat(e.width);this.step=r+t}},{key:"countCardsView",value:function(){var e=this.carouselMask.currentStyle||window.getComputedStyle(this.carouselMask);this.cardsVeiwCount=Math.ceil(parseFloat(e.width)/this.step)}},{key:"countPagesNumber",value:function(){this.pagesNumber=Math.ceil(this.cardsCount/this.cardsVeiwCount)}},{key:"setCurrentPageNumberAfterResize",value:function(){this.currentPage=Math.ceil(this.leftCardNumber/this.cardsVeiwCount)}},{key:"setCorrectLeft",value:function(){this.carouselCardsLeft=-1*(this.currentPage-1)*this.cardsVeiwCount*this.step,this.carouselCards.style.left=this.carouselCardsLeft+"px"}},{key:"fixView",value:function(){this.calcStep(),this.setCurrentPageNumberAfterResize(),this.setCorrectLeft(),this.countCardsView(),this.countPagesNumber(),console.log("count pages "+this.pagesNumber),console.log("page number "+this.currentPage),this.updateIndicators()}},{key:"showNextBlock",value:function(){this.currentPage>=this.pagesNumber||(this.carouselCardsLeft-=this.step*this.cardsVeiwCount,this.carouselCards.style.left=this.carouselCardsLeft+"px",this.leftCardNumber=this.currentPage*this.cardsVeiwCount+1,this.currentPage++,this.checkPagesForDataUpdate(),console.log("page number "+this.currentPage),console.log("left card number "+this.leftCardNumber),this.updateIndicators())}},{key:"showPrevBlock",value:function(){1!==this.currentPage&&(this.currentPage--,this.leftCardNumber=(this.currentPage-1)*this.cardsVeiwCount+1,this.carouselCardsLeft+=this.step*this.cardsVeiwCount,this.carouselCards.style.left=this.carouselCardsLeft+"px",console.log("page number "+this.currentPage),console.log("left card number "+this.leftCardNumber),this.updateIndicators())}},{key:"showIndexBlock",value:function(e){var t=+e.target.innerText;this.currentPage!==t&&(this.leftCardNumber=(t-1)*this.cardsVeiwCount+1,this.carouselCardsLeft=-1*this.step*(this.leftCardNumber-1),this.carouselCards.style.left=this.carouselCardsLeft+"px",this.currentPage=t,this.checkPagesForDataUpdate(),this.updateIndicators())}},{key:"checkPagesForDataUpdate",value:function(){this.pagesNumber-this.currentPage<Math.floor(this.maxIndicatorsNumber/2)&&this.notifyControllerToLoadData()}},{key:"swipeStart",value:function(e){if("mousedown"===e.type)this.touchStartX=e.pageX,e.preventDefault();else{if(1!==e.touches.length)return;this.touchStartX=e.changedTouches[0].pageX}}},{key:"swipeMove",value:function(e){if(this.touchStartX){var t=e.pageX||e.changedTouches[0].pageX;this.diffStartEndX=-1*(this.touchStartX-t),this.moveCarouselCards(),e.preventDefault()}}},{key:"swipeEnd",value:function(e){("touchend"===e.type||this.touchStartX&&e.pageX)&&(this.touchEndX=e.pageX||e.changedTouches[0].pageX,this.diffStartEndX=this.touchEndX-this.touchStartX,this.touchStartX=null,this.carouselCards.style.left=this.carouselCardsLeft+"px",this.changeSlides(),"mouseup"===e.type&&e.preventDefault())}},{key:"changeSlides",value:function(){this.diffStartEndX>0&&this.diffStartEndX>this.step/3&&this.showPrevBlock(),this.diffStartEndX<0&&this.diffStartEndX<-(this.step/3)&&this.showNextBlock()}},{key:"moveCarouselCards",value:function(){this.diffStartEndX=this.carouselCardsLeft+this.diffStartEndX,this.carouselCards.style.left=this.diffStartEndX+"px"}},{key:"notifyControllerToLoadData",value:function(){this.observer.forEach(function(e){e.loadNextPart()})}},{key:"addObserver",value:function(e){this.observer.push(e)}}]),e}();t.CarouselView=n},function(e,t,r){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Title=void 0;var a=r(5),n=function e(){s(this,e),this.titlePage=new a.TitlePageView,this.titlePage.showTitle()};t.Title=n},function(e,t,r){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}();r(10);t.TitlePageView=function(){function e(t){s(this,e),this.rootElement=t||document.body}return a(e,[{key:"showTitle",value:function(){var e='\n                <div class="title">\n                    <img src="./images/My-youtube-red.jpg" alt="My youtube logo">\n                    <h1>My Youtube</h1>\n                </div>  \n                ';this.rootElement.insertAdjacentHTML("beforeEnd",e)}}]),e}()},function(e,t,r){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Search=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),n=r(8),i=r(7),o=function(){function e(){s(this,e),this.seachField=new n.SearchField,this.searchStr=new i.SearchStr;var t=document.getElementById("search");this.addEventSubmitTo(t)}return a(e,[{key:"addEventSubmitTo",value:function(e){var t=this;e.addEventListener("submit",function(e){t.searchStr.addStr(e.target[0].value),t.searchStr.observerNotify()})}}]),e}();t.Search=o},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),a=function(){function e(){r(this,e),this.queryText="",this.observerList=[]}return s(e,[{key:"addStr",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.queryText=e}},{key:"observerAdd",value:function(e){console.log("add to arr observers"),this.observerList.push(e)}},{key:"observerNotify",value:function(){var e=this;console.log("notify"),this.observerList.forEach(function(t){t.getDataRequest(e.queryText)})}},{key:"observerCount",value:function(){return this.observerList.length}},{key:"observerRemove",value:function(e){this.observerList.splice(e,1)}},{key:"observerIndexOf",value:function(e){for(var t=0,r=this.observerList.length;t<r;t++)if(e===this.observerList[t])return t}},{key:"observerGetObj",value:function(e){return this.observerList[e]}}]),e}();t.SearchStr=a},function(e,t,r){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}();r(11);t.SearchField=function(){function e(t){s(this,e),this.rootElement=t||document.body,this.showSearchField()}return a(e,[{key:"showSearchField",value:function(){var e='\n                <div class="wrapper_search">\n                    <form action="javascript:;" id="search" class="search__form"  method="GET" name="searchForm">\n                        <label for="search__input"></label>\n                        <input id="search__input" name="queryStr" type="text" placeholder="search text" autofocus>\n                    </form>\n                </div>\n                <pre id="response"></pre>   \n                ';this.rootElement.insertAdjacentHTML("beforeEnd",e)}}]),e}()},function(e,t){},function(e,t){},function(e,t){}]);
//# sourceMappingURL=main.js.map